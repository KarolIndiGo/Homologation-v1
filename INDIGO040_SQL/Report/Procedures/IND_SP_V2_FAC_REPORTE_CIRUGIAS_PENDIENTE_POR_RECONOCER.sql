-- Workspace: SQLServer
-- Item: INDIGO040 [SQL]
-- ItemId: SPN
-- Schema: Report
-- Object: IND_SP_V2_FAC_REPORTE_CIRUGIAS_PENDIENTE_POR_RECONOCER
-- Extracted by Fabric SQL Extractor SPN v3.9.0



CREATE PROCEDURE [Report].[IND_SP_V2_FAC_REPORTE_CIRUGIAS_PENDIENTE_POR_RECONOCER]
AS
SELECT 'CIRUGIAS' 'TIPO', cast(HOS.NUMINGRES as varchar )'INGRESO' ,HOS.IESTADOIN 'ESTADO',CAST(HOS.[FECHA INGRESO] AS date) [FECHA INGRESO],HOS.ENTIDAD ,HOS.[GRUPO ATENCION]  ,HOS.IPCODPACI 'IDENTIFICACION' ,HOS.IPNOMCOMP 'NOMBRE' ,HOS.CODSERIPS 'CUPS' ,HOS.DESSERIPS 'DESCRIPCION CUPS',
HOS.[CANTIDAD ORDENADA]  ,HOS.CANSERIPS 'CANTIDAD PENDIENTE DE CARGUE',HOS.UFUDESCRI 'UNIDAD FUNCIONAL',HOS.NUMCAMHOS 'CAMA' ,HOS.FECEGRESO 'FECHA EGRESO',
HOS.[AMBITO CIRUGIA] ,HOS.[CUPS CARGADO] , HOS.[CANTIDAD CARGADA]  ,YEAR(HOS.[FECHA INGRESO]) 'AÃ‘O INGRESO' ,month(HOS.[FECHA INGRESO]) 'MES INGRESO', HOS.[VIA DE ABORADAJE],
HOS.[CIRUJANO],ISNULL(HOS.CANSERIPS*QX.[VALOR UNITARIO],0) 'VALOR PROMEDIO',HOS.[FECHA CIRUGIA]
FROM REPORT.View_V2_FAC_REPORTE_PROCEDIMIENTOS_QX_POR_RECONOCER HOS
LEFT JOIN REPORT.View_V2_FAC_REPORTE_PROCEDIMIENTOS_QX_POR_RECONOCER_VALORIZADO AS QX ON QX.[CUPS]=HOS.CODSERIPS



