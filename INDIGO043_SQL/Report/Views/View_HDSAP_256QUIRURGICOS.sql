-- Workspace: SQLServer
-- Item: INDIGO043 [SQL]
-- ItemId: SPN
-- Schema: Report
-- Object: View_HDSAP_256QUIRURGICOS
-- Extracted by Fabric SQL Extractor SPN v3.9.0




CREATE VIEW [Report].[View_HDSAP_256QUIRURGICOS]
AS

			SELECT        
			'TIPO DE IDENTIFICACION' = CASE Pa.IPTIPODOC
			WHEN '1' THEN 'Cédula de Ciudadanía'
			WHEN '2' THEN 'Cédula de Extranjería'
			WHEN '3' THEN 'Tarjeta de Identidad'
			WHEN '4' THEN 'Registro Civil'
			WHEN '5' THEN 'Pasporte'
			WHEN '6' THEN 'Adulto Sin Identificación'
			ELSE 'Menor Sin Identificación'
			END,
			Q.IPCODPACI AS 'NUMERO DE IDENTIFICACION',
			CAST(Pa.IPFECNACI AS date) AS 'FECHA DE NACIMINETO',
			'SEXO PACIENTE'= CASE Pa.IPSEXOPAC
					 WHEN '1' THEN 'HOMBRE'
			   WHEN '2' THEN 'MUJER'
					 ELSE 'INDEFINIDO'
			   end,
			Pa.IPPRIAPEL AS 'PRIMER APELLIDO',
			Pa.IPSEGAPEL as 'SEGUNDO APELLIDO',
			Pa.IPPRINOMB as 'PRIMER NOMBRE',
			Pa.IPSEGNOMB as 'SEGUNDO NOMBRE',
			Q.CODSERIPS,
			GrA.Name AS GrupoAtencion,
			EntA.Name AS Entidad,
			INUBICACI.DEPMUNCOD AS Municipio,
			Q2.CODSERIPS AS 'CODIGO DE PROCEDIMIENTO',
			CAST(Q.FECHORINI AS DATE) AS FECHAPROCEDIMIENTO,
			CASE WHEN Q.URGECIRUG = 'TRUE' THEN 'URGENCIA' WHEN Q.URGECIRUG = 'FALSE' THEN 'PROGRAMADA' END AS Tipo
FROM            HCQXINFOR AS Q INNER JOIN
                         INPROFSAL AS P ON P.CODPROSAL = Q.CODPROSAL INNER JOIN
                         INDIAGNOS AS DX2 ON Q.CODDIAPRE = DX2.CODDIAGNO INNER JOIN
                         INDIAGNOS AS DX ON Q.CODDIAPRE = DX.CODDIAGNO INNER JOIN
                         INESPECIA AS E ON P.CODESPEC1 = E.CODESPECI INNER JOIN
                         INCUPSIPS AS C ON C.CODSERIPS = Q.CODSERIPS INNER JOIN
                         HCQXREALI AS Q2 ON Q.NUMEFOLIO = Q2.NUMEFOLIO AND Q.IPCODPACI = Q2.IPCODPACI AND Q.NUMINGRES = Q2.NUMINGRES INNER JOIN
                         INCUPSIPS AS C2 ON C2.CODSERIPS = Q2.CODSERIPS INNER JOIN
                         INPACIENT AS Pa ON Q.IPCODPACI = Pa.IPCODPACI INNER JOIN
                         INUBICACI ON Pa.AUUBICACI = INUBICACI.AUUBICACI INNER JOIN
                         ADINGRESO AS Ing ON Q.IPCODPACI = Ing.IPCODPACI AND Q.NUMINGRES = Ing.NUMINGRES INNER JOIN
                         Contract.CareGroup AS GrA ON Ing.GENCAREGROUP = GrA.Id INNER JOIN
                         Contract.HealthAdministrator AS EntA ON Ing.GENCONENTITY = EntA.Id
  

