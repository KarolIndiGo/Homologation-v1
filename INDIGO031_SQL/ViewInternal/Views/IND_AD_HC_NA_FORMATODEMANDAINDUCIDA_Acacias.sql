-- Workspace: SQLServer
-- Item: INDIGO031 [SQL]
-- ItemId: SPN
-- Schema: ViewInternal
-- Object: IND_AD_HC_NA_FORMATODEMANDAINDUCIDA_Acacias
-- Extracted by Fabric SQL Extractor SPN v3.9.0

CREATE VIEW [ViewInternal].[IND_AD_HC_NA_FORMATODEMANDAINDUCIDA_Acacias] as

select 	nota.NOMBRE as Nota, c.FECHACREACION as [Fecha],    CASE
                WHEN c.codcenate IN(002, 003, 004, 005, 006, 007, 008, 009,017)
                THEN 'BOYACA'
                WHEN c.codcenate IN(010, 011, 012, 013, 014)
                THEN 'META'
                WHEN c.codcenate IN (015,016)
                THEN 'CASANARE'
            END AS Departamento, c.codcenate, ce.nomcenate  as IPSPrimaria , P.IPPRINOMB AS [Primer Nombre], P.IPSEGNOMB AS [Segundo Nombre], P.IPPRIAPEL AS [Primer Apellido], 
	P.IPSEGAPEL AS [Segundo Apellido],  CASE WHEN P.IPTIPODOC = '1' THEN 'CC' WHEN P.IPTIPODOC = '2' THEN 'CE' 
	   WHEN P.IPTIPODOC = '3' THEN 'TI' WHEN P.IPTIPODOC = '4' THEN 'RC' WHEN P.IPTIPODOC = '5' THEN 'PA' 
	   WHEN P.IPTIPODOC = '6' THEN 'AS' WHEN P.IPTIPODOC
            = '7' THEN 'MS' WHEN P.IPTIPODOC='8' THEN 'NU'  when P.IPTIPODOC='9' then 'NV'  when P.IPTIPODOC='12' then 'PE'  END AS TipoIdentificación,
	 c.ipcodpaci as NroIdentificacion, p.ipfecnaci as FechaNacimiento, YEAR(c.FECHACREACION) - YEAR(P.IPFECNACI) AS Edad,   CASE WHEN P.IPSEXOPAC = '1' THEN 'M' WHEN P.IPSEXOPAC = '2' THEN 'F' END AS Sexo, 
	 p.IPDIRECCI AS Direccion, p.iptelefon+'-'+p.iptelmovi as Telefono,
	 c.numingres as Ingreso,
		TipoSeguimiento.Valor as [Tipo Seguimiento], atepuerperio.VALOR as [ATENCIÓN AL PUERPERIO], FECHAatepuerperio.VALOR AS [FECHA ATENCIÓN AL PUERPERIO],
		aterecnaci.valor as [ATENCIÓN AL RECIÉN NACIDO],fechaaterecnaci.valor AS [FECHA ATENCIÓN AL RECIÉN NACIDO],
		planfam.valor as [PLANIFICACIÓN FAMILIAR Y ANTICONCEPCIÓN], fechaplanfam.valor as [FECHA PLANIFICACIÓN FAMILIAR Y ANTICONCEPCIÓN],
		priinf.valor as [PROGRAMA DE PRIMERA INFANCIA], fechapriinf.valor as [FECHA PROGRAMA DE PRIMERA INFANCIA],infanc.valor as [PROGRAMA DE INFANCIA], fechainfanc.valor as [FECHA PROGRAMA DE INFANCIA],
		adoles.valor as [PROGRAMA DE ADOLESCENCIA],fechaadoles.valor as [FECHA PROGRAMA DE ADOLESCENCIA],juvent.valor as [PROGRAMA DE JUVENTUD], fechajuvent.valor as [FECHA PROGRAMA DE JUVENTUD],
		adulto.valor as [PROGRAMA DE ADULTEZ], fechaadulto.valor as [FECHA PROGRAMA DE ADULTEZ],
		vejez.valor as [PROGRAMA DE VEJEZ], fechavejez.valor as [FECHA PROGRAMA DE VEJEZ],prenat.valor as [ATENCIÓN AL CUIDADO PRENATAL], fechaprenat.valor as [FECHA ATENCIÓN AL CUIDADO PRENATAL],
		curso.valor as [CURSO PREPARACIÓN PARA MATERNIDAD Y PATERNIDAD],fechacurso.valor as [FECHA CURSO PREPARACIÓN PARA MATERNIDAD Y PATERNIDAD], bucal.valor as [SALUD BUCAL], fechabucal.valor as [FECHA SALUD BUCAL], 
		cuelloute.valor as [DETECCIÓN TEMPRANA CÁNCER CUELLO UTERINO], fechacuelloute.valor as [FECHA DETECCIÓN TEMPRANA CÁNCER CUELLO UTERINO],
		mama.valor as [DETECCIÓN TEMPRANA CÁNCER MAMA], fechamama.valor as [FECHA DETECCIÓN TEMPRANA CÁNCER MAMA],prostata.valor as [DETECCIÓN TEMPRANA CÁNCER PRÓSTATA], 
		fechaprostata.valor as [FECHA DETECCIÓN TEMPRANA CÁNCER PRÓSTATA],
		colon.valor as [DETECCIÓN TEMPRANA CÁNCER COLON Y RECTO], fechacolon.valor as [FECHA DETECCIÓN TEMPRANA CÁNCER COLON Y RECTO],preconcepcional.valor as [ATENCION AL CUIDADO PRECONCEPCIONAL],
		fechapreconcepcional.valor as [FECHA ATENCION AL CUIDADO PRECONCEPCIONAL],
		vacunacion.valor as [VACUNACIÓN], fechavacunacion.valor as [FECHA VACUNACIÓN],lactancia.valor as [APOYO A LA LACTANCIA MATERNA], fechalactancia.valor as [FECHA APOYO A LA LACTANCIA MATERNA],
		educacion.valor as [CICLOS EDUCACIÓN Y COMUNICACIÓN],fechaeducacion.valor as [FECHAvalor CICLOS EDUCACIÓN Y COMUNICACIÓN],metab.VALOR as [SINDROME METABÓLICO],
		Fechametabgen.VALOR as [FECHA SINDROME METABÓLICO MEDICO GENERAL], Fechametabint.valor as [FECHA SINDROME METABÓLICO MEDICO INTERNISTA], Fechametabfam.valor as [FECHA SINDROME METABÓLICO MEDICO FAMILIAR],
		Fechametabpsic.valor as [FECHA SINDROME METABÓLICO PSICOLOGO], Fechametabnutri.valor as [FECHA SINDROME METABÓLICO NUTRICIONISTA], Fechametabenf.valor as [FECHA SINDROME METABÓLICO ENFERMERIA],
		Fechametabtsoc.valor as [FECHA SINDROME METABÓLICO TRABAJO SOCIAL],
		victima.valor as [ATENCIÓN A VÍCTIMAS DE VIOLENCIA SEXUAL], fechavictima.valor as [FECHA ATENCIÓN VÍCTIMAS VIOLENCIA SEXUAL],
		mental.valor as [SALUD MENTAL], fechamental.valor  as [FECHA SALUD MENTAL],otro.valor as [OTRO], fechaotro.valor  as [FECHA OTRO],domici.valor as [VISITA DOMICILIARIA], 
		llamada.valor as [LLAMADA  TELEFÓNICA], resultado.valor as [RESULTADO DE LA LLAMADA O DE LA VISITA DOCIMILIARIA],
		asigna.Valor as [FECHA ASIGNACIÓN CITA (AAAA-MM-DD)], motivo.valor as [MOTIVO DE LA INASISTENCIA O CANCELACIÓN DE LA CITA], asistencia.valor as [ASISTENCIA DEL USUARIO A LA CONSULTA ASIGNADA], observaciones.valor as Observaciones, 
		u.nomusuari as [Funcionario Realiza Demanda Inducida]
FROM   [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
--INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D ON D.IDNTNOTASADMINISTRATIVASC=C.ID
INNER JOIN [Dbo].[NTADMINISTRATIVAS] AS NOTA WITH (NOLOCK) ON NOTA.ID=C.IDNOTAADMINISTRATIVA 
inner join [Dbo].inpacient as p WITH (NOLOCK) on p.ipcodpaci=c.ipcodpaci
inner join [Dbo].segusuaru as u WITH (NOLOCK) on u.codusuari=c.codusuari
inner join [Dbo].adcenaten as ce WITH (NOLOCK) on ce.codcenate=c.codcenate
--inicia los subquerys para las columnas
left outer join (
	select vari.id as VariID, variable, CASE WHEN  vard.NOMBRE IS NOT NULL THEN vard.NOMBRE ELSE d.valor END AS Valor , D.IDNTNOTASADMINISTRATIVASC
	from [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK)
	inner join [Dbo].NTVARIABLES as vari WITH (NOLOCK) on vari.id=d.IDNTVARIABLE
	left outer join [Dbo].NTVARIABLESL as vard WITH (NOLOCK) on vard.id=d.iditemlista
	where  vari.id='2') as TipoSeguimiento on TipoSeguimiento.IDNTNOTASADMINISTRATIVASC=C.ID
left outer join (
	select vari.id as VariID, variable, CASE WHEN  vard.NOMBRE IS NOT NULL THEN vard.NOMBRE ELSE d.valor END AS Valor , D.IDNTNOTASADMINISTRATIVASC
	from [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK)
	inner join [Dbo].NTVARIABLES as vari WITH (NOLOCK) on vari.id=d.IDNTVARIABLE
	left outer join [Dbo].NTVARIABLESL as vard WITH (NOLOCK) on vard.id=d.iditemlista
	where  vari.id='1') as observaciones on observaciones.IDNTNOTASADMINISTRATIVASC=C.ID
left outer join ( 
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES as vari WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=4 ) as atepuerperio on atepuerperio.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join ( 
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES as vari WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=73 ) as FECHAatepuerperio on FECHAatepuerperio.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES as vari WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=5) as aterecnaci on aterecnaci.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES as vari WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=74) as fechaaterecnaci on fechaaterecnaci.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES as vari WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=6) as planfam on planfam.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES as vari WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=75) as fechaplanfam on fechaplanfam.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES as vari WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=7) as priinf on priinf.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES as vari WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=76) as fechapriinf on fechapriinf.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES as vari WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=8) as infanc on infanc.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES as vari WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=77) as fechainfanc on fechainfanc.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES as vari WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=9) as adoles on adoles.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES as vari WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=78) as fechaadoles on fechaadoles.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES as vari WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=10) as juvent on juvent.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES as vari WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=79) as fechajuvent on fechajuvent.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=11) as adulto on adulto.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=80) as fechaadulto on fechaadulto.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=12) as vejez on vejez.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=81) as fechavejez on fechavejez.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=13) as prenat on prenat.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=82) as fechaprenat on fechaprenat.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=14) as curso on curso.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=83) as fechacurso on fechacurso.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=15) as bucal on bucal.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=84) as fechabucal on fechabucal.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=16) as cuelloute on cuelloute.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=85) as fechacuelloute on fechacuelloute.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=17) as mama on mama.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=86) as fechamama on fechamama.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=18) as prostata on prostata.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=87) as fechaprostata on fechaprostata.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=18) as colon on colon.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=88) as fechacolon on fechacolon.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=20) as preconcepcional on preconcepcional.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=89) as fechapreconcepcional on fechapreconcepcional.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES as vari ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=21) as vacunacion on vacunacion.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES as vari ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=90) as fechavacunacion on fechavacunacion.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=22) as lactancia on lactancia.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES as vari ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=91) as fechalactancia on fechalactancia.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES as vari ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=23) as educacion on educacion.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=92) as fechaeducacion on fechaeducacion.IDNTNOTASADMINISTRATIVASC=c.ID
	--REVISAR
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE  D.IDNTVARIABLE=24) as metab on metab.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE  D.IDNTVARIABLE=93) as fechametabgen on fechametabgen.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE  D.IDNTVARIABLE=97) as fechametabint on fechametabint.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE  D.IDNTVARIABLE=98) as fechametabfam on fechametabfam.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE  D.IDNTVARIABLE=99) as fechametabpsic on fechametabpsic.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE  D.IDNTVARIABLE=100) as fechametabnutri on fechametabnutri.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE  D.IDNTVARIABLE=101) as fechametabenf on fechametabenf.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES as vari ON VARI.ID= D.IDNTVARIABLE
	WHERE  D.IDNTVARIABLE=102) as fechametabtsoc on fechametabtsoc.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=25) as victima on victima.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=94) as fechavictima on fechavictima.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=26) as mental on mental.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=95) as fechamental on fechamental.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor  AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=27) as otro on otro.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
	SELECT vari.id as VariID, variable, d.valor AS Valor , D.IDNTNOTASADMINISTRATIVASC
	FROM  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)
	INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS D WITH (NOLOCK) ON C.ID=D.IDNTNOTASADMINISTRATIVASC
	INNER JOIN [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON VARI.ID= D.IDNTVARIABLE
	WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=96) as fechaotro on fechaotro.IDNTNOTASADMINISTRATIVASC=c.ID
left outer join (
		select vari.id as VariID, variable, CASE WHEN  vard.NOMBRE IS NOT NULL THEN vard.NOMBRE ELSE d.valor END AS Valor , D.IDNTNOTASADMINISTRATIVASC
		from [Dbo].[NTNOTASADMINISTRATIVASD] AS D 
		inner join [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON vari.id=d.IDNTVARIABLE
		left outer join [Dbo].NTVARIABLESL AS VARD WITH (NOLOCK) ON vard.id=d.iditemlista
		where  vari.id=28) as domici  on domici.IDNTNOTASADMINISTRATIVASC=C.ID
left outer join (
	select vari.id as VariID, variable, CASE WHEN  vard.NOMBRE IS NOT NULL THEN vard.NOMBRE ELSE d.valor END AS Valor , D.IDNTNOTASADMINISTRATIVASC
	from [Dbo].[NTNOTASADMINISTRATIVASD] AS D 
	inner join [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON vari.id=d.IDNTVARIABLE
	left outer join [Dbo].NTVARIABLESL AS VARD WITH (NOLOCK) ON vard.id=d.iditemlista
	where  vari.id=29) as llamada  on llamada.IDNTNOTASADMINISTRATIVASC=C.ID
left outer join (
	select vari.id as VariID, variable, CASE WHEN  vard.NOMBRE IS NOT NULL THEN vard.NOMBRE ELSE d.valor END AS Valor , D.IDNTNOTASADMINISTRATIVASC
	from [Dbo].[NTNOTASADMINISTRATIVASD] AS D 
	inner join [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON vari.id=d.IDNTVARIABLE
	left outer join [Dbo].NTVARIABLESL AS VARD WITH (NOLOCK) ON vard.id=d.iditemlista
	where  vari.id=30) as resultado  on resultado.IDNTNOTASADMINISTRATIVASC=C.ID
left outer join (
	select vari.id as VariID, variable, CASE WHEN  vard.NOMBRE IS NOT NULL THEN vard.NOMBRE ELSE d.valor END AS Valor , D.IDNTNOTASADMINISTRATIVASC
	from [Dbo].[NTNOTASADMINISTRATIVASD] AS D 
	inner join [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON vari.id=d.IDNTVARIABLE
	left outer join [Dbo].NTVARIABLESL AS VARD WITH (NOLOCK) ON vard.id=d.iditemlista
	where  vari.id=31) as asigna  on asigna.IDNTNOTASADMINISTRATIVASC=C.ID
left outer join (
	select vari.id as VariID, variable, CASE WHEN  vard.NOMBRE IS NOT NULL THEN vard.NOMBRE ELSE d.valor END AS Valor , D.IDNTNOTASADMINISTRATIVASC
	from [Dbo].[NTNOTASADMINISTRATIVASD] AS D 
	inner join [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON vari.id=d.IDNTVARIABLE
	left outer join [Dbo].NTVARIABLESL AS VARD WITH (NOLOCK) ON vard.id=d.iditemlista
	where  vari.id=32) as motivo  on motivo.IDNTNOTASADMINISTRATIVASC=C.ID
left outer join (
	select vari.id as VariID, variable, CASE WHEN  vard.NOMBRE IS NOT NULL THEN vard.NOMBRE ELSE d.valor END AS Valor , D.IDNTNOTASADMINISTRATIVASC
	from [Dbo].[NTNOTASADMINISTRATIVASD] AS D 
	inner join [Dbo].NTVARIABLES AS VARI WITH (NOLOCK) ON vari.id=d.IDNTVARIABLE
	left outer join [Dbo].NTVARIABLESL AS VARD WITH (NOLOCK) ON vard.id=d.iditemlista
	where  vari.id=33) as asistencia  on asistencia.IDNTNOTASADMINISTRATIVASC=C.ID
--finaliza los subquerys para las columnas
WHERE 
NOTA.CODIGO='00002' and c.codcenate = '011'
AND C.FECHACREACION>='2024-02-01' 
and c.ipcodpaci<>'0000'


--SELECT VARI.VARIABLE AS VARPADRE, D.VALOR AS valor, D.IDNTNOTASADMINISTRATIVASC,C.IPCODPACI, varih.id,VARIH.VARIABLE AS VARHIJO --, DH.VALOR AS VRHIJO
-- from [Dbo].[NTNOTASADMINISTRATIVASD] AS D 
-- INNER JOIN  [Dbo].NTNOTASADMINISTRATIVASC AS C WITH (NOLOCK)ON C.ID=D.IDNTNOTASADMINISTRATIVASC
-- INNER JOIN [Dbo].NTVARIABLES as vari ON VARI.ID= D.IDNTVARIABLE
--  INNER JOIN [Dbo].NTVARIABLESD as variD ON VARID.IDPADRE= D.IDNTVARIABLE
--   INNER JOIN [Dbo].NTVARIABLES as variH ON VARIH.ID= variD.IDHIJO 
--   --INNER JOIN [Dbo].[NTNOTASADMINISTRATIVASD] AS DH ON DH.IDNTVARIABLE=VARIH.ID
-- WHERE D.IDGRUPO=2 AND D.IDNTVARIABLE=5 and c.ipcodpaci='40342933'


 --SELECT *
 --FROM  [Dbo].NTVARIABLES 
 --WHERE VARIABLE LIKE '%fecha%'
